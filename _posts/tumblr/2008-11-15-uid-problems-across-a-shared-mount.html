---
layout: post
title: UID problems across a shared mount?
tags:
- uniq
- linux
- sysadmin
- uid
- usermod
---
<p>We just moved to new Ubuntu servers.</p>
<p>We use file-column (with some modifications) to deal with our file uploads.</p>
<pre><code>deploy@jgp-web01:/var/www/oursite$ ls -l public/uploaded_file/file_name/000/000/051/585/ <br/>total 4<br/>-rw-r--r-- 1 gerhard www-data 2670 2008-11-15 05:09 MatthewJacobsCV.txt<br/><br/></code><code>deploy@jgp-web02:/var/www/oursite$ ls -l public/uploaded_file/file_name/000/000/051/585/ <br/>total 4<br/>-rw-r--r-- 1 deploy www-data 2670 2008-11-15 05:09 MatthewJacobsCV.txt<br/></code><br/></pre>
<p>If you look carefully, you&#8217;ll see one is owned by &#8220;deploy&#8221; and the other by &#8220;gerhard&#8221;.</p>
<p>These are mounted by NFS, shared across the two computers.</p>
<p>So these are actually the same file, but with different permissions on each.</p>
<p>A quick use of the &#8220;id&#8221; command confirmed this;</p>
<pre><code>deploy@jgp-web01:~$ id deploy<br/>uid=1004(deploy) gid=33(www-data) groups=33(www-data),1005(aspire)<br/><br/>deploy@jgp-web02:~$ id deploy<br/>uid=1002(deploy) gid=33(www-data) groups=33(www-data),1003(aspire)</code></pre>
<p>The answer is;</p>
<pre><code>root@jgp-web01:~# usermod -u 10000 deploy<br/><br/>root@jgp-web02:~# usermod -u 10000 deploy</code></pre>
<p>boom!</p>
<p>Now this is resolved, but you&#8217;ll have to chown all the existing files, back to `deploy`, else they&#8217;ll still be attached to the old uid.</p>
